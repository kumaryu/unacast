# 詳細な使い方

`基本的な使い方`で解説していない機能について。

## 動作中の設定変更
<img src="help/img/help13.jpg" />

サーバー起動中、停止せずに一部の設定を変更することができます。
各項目を変更した後、`適用`ボタンをクリックしてください。
掲示板URLを変更した場合、そのスレの最新の1レスだけが追加で表示されます。

## レス・コメント取得先

<img src="help/img/help07.jpg" />

- ステータス欄

  各取得先に対する読み込み状況や通信状況を表示します。
  表示内容はサービスによって異なります。
  上記画像の例だと以下の通りになります。

    - 掲示板: 通信OK。レス34番まで読み込んだ
    - Youtube: 通信OK。Youtube配信時に払い出されるLiveIDがSwhzrtMayrM
    - Twitch: 通信OK。
    - ニコニコ: 配信開始待ち

## 掲示板取得設定

<img src="help/img/help08.jpg" />

- 開始レス番号

  その名の通り、掲示板を読み込んだ時に表示する起点のレス番号となります。
  上記の例だと30を指定しているので、30番より後のレスが初期表示となります。

     <img src="help/img/help09.jpg" width=300 />

- 更新間隔
  掲示板のリロード間隔です。
  各サービスに負荷のかからない範囲で設定してください。

## 表示設定

<img src="help/img/help10.jpg" />

- 表示タイプ
  - チャット風: 受信した全てのレスを表示します。
    - 画面の高さに入り切らない分は画面外に流れていきます。
  - SpeechCast風: 受信したレスを1つずつ表示・非表示を切り替えていきます。
- 初期表示テキスト
  - 表示タイプによって動作が変わります
    - チャット風: レスの先頭位置にテキストを表示します。レスの受信と共に流れていきます。
    - SpeechCast風: レスが無い間、テキストを表示し続けます。
- アイコン表示
  - レスごとのアイコンを表示します。
- レス番表示
  - レス番号・コメント番号があるサービスについて、番号を表示します。
- 時刻表示
  - レス時刻を表示します。
- 横幅超過時に自動改行する。
  - レスの文量がウィンドウ幅を超過した時、ウィンドウ幅に合わせて文字を折り返します。
- レス表示順序
  - 新着レスを上に積むか、下に積むかを選択します。
- 名前と本文を改行で分ける
  - そのまま。
- 画像URLのサムネイル表示
  - 画像拡張子(png/jpg/gif)のURLが貼られた時、画像をサムネイル表示します。

サムネイル表示がオンの時は、以下のように表示されます。

<img src="help/img/help15.jpg" width=300 />

## レス・コメント着信音設定

着信音のフォルダパスに含まれる`.wav`ファイルをランダムに再生します。


## 読み子設定
<img src="help/img/help11.jpg" width=300 />

受信したレスの本文を各種読み上げソフトに渡します。

読み上げソフトにVOICEVOXを指定した場合、システムにインストールされているVOICEVOX(バージョン0.14以降)を自動的に読み込んで使用します。
VOICEVOXを別に起動しておく必要はありません。
インストール先のパスは空に設定しておくと通常の場所にインストールされている場合は自動的に検出します。
既定とは異なる場所にインストールされている場合はインストール先(`voicevox_core.dll`または`voicevox_core.dylib`がある場所)を入力してください。

## Azure 音声認識
<img src="help/img/help16.jpg" width=300 />

マイクから入力した音声を認識し、レスの中に混ぜて表示します。

Azure の有料機能(一定量は無料)を使用するため、 Azure の登録とリソースの作成が必要です。
[ドキュメント](https://learn.microsoft.com/ja-jp/azure/cognitive-services/cognitive-services-apis-create-account?tabs=speech%2Canomaly-detector%2Clanguage-service%2Ccomputer-vision%2Cwindows#get-the-keys-for-your-resource) を参考に、音声サービスを作成し、キーと場所/地域を取得します。

- 有効にする
  音声認識を使うかどうかを選びます。
  有効でも音声サービスキーと音声サービス場所/地域が正しく設定されていない場合は動きません。

- 発言者名
  認識したテキストの名前として表示されるものです。

- 音声サービスキー(キー1またはキー2)
  Azure で作成した音声サービスのキーをコピーして設定します。キー1とキー2のどちらでもかまいません。

- 音声サービス場所/地域
  Azure で作成した音声サービスの場所/地域の値をコピーして設定します。

- 認識する言語
  音声認識で認識する言語を選びます。

- 音声入力デバイス
  音声入力に使用するデバイスを選びます。

## その他
<img src="help/img/help12.jpg" />

- スレのレス番号が超えた時に通知する値
  - 例えば掲示板のレス数が1000になった時に通知する機能です。その場合は`1000`を入力してください。
  - `0`を入力した場合は通知を行いません。

- 掲示板が連続で通信エラーになった時に通知する閾値
  - 項目名の通り。

- レスの処理単位
  - 複数のレス、コメントを一気に受信した時に、まとめて表示するか、一つずつ表示するかを選択します。
  - 主に表示タイプ`SpeechCast風`で活きる設定です。

---

## タスクトレイ
<img src="help/img/help14.jpg" />

- 左クリック
  - chatウィンドウにフォーカス
- 左ダブルクリック
  - 設定ウィンドウにフォーカス
- 右クリック
  - 設定: 設定ウィンドウにフォーカス
  - コメント: chatウィンドウにフォーカス
  - 終了: このアプリケーションを終了
